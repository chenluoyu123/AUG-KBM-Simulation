# plot the q and kinetic profiles in a publication level
import matplotlib.pyplot as plt
figure(figsize=[6,8])
lw=3
fs2=24
subplot(211)
inputgacode=OMFIT['INPUTS']['input.gacode']
plot(inputgacode['rho'],inputgacode['Ti_1'],'-b',linewidth=lw,label='$T_i(keV)$')
plot(inputgacode['rho'],inputgacode['Te'],'--b',linewidth=lw,label='$T_e(keV)$')
plot(inputgacode['rho'],inputgacode['ne'],'-k',linewidth=lw,label='$n_e(10^{19}m^{-3})$')
plot(inputgacode['rho'],-1*inputgacode['q'],'-r',linewidth=lw,label='q')
plot(array([0,1]),array([1,1]),'--r',linewidth=lw/2)
#xlabel('$\\rho$',fontsize=fs2)
text(0.35,6,'$n_e(10^{19}m^{-3})$',color='k',fontsize=fs2)
text(0.01,4,'$T_e(keV)$',color='b',fontsize=fs2)
text(0.10,8.0,'$T_i(keV)$',color='b',fontsize=fs2)
text(0.2,1.5,'q',color='r',fontsize=fs2)
text(0.8,8.0,'(a)',fontsize=fs2-4)
xlim([0,1.0])
ylim([0,9])
#xticks(linspace(0,0.9,4),fontsize=fs2)
xticks([],fontsize=fs2)
yticks(array([1,3,6,9]),fontsize=fs2)
subplot(212)
a=inputgacode['rmin'][-1]
plot(inputgacode['rho'],a*inputgacode['dlnnedr'],'-k',linewidth=lw)
plot(inputgacode['rho'],a*inputgacode['dlntedr'],'--b',linewidth=lw)
plot(inputgacode['rho'],a*inputgacode['dlntidr_1'],'-b',linewidth=lw)
plot(inputgacode['rho'],a*inputgacode['s'],'-r',linewidth=lw)
text(0.30,3.5,'$a/L_{Ti}$',color='b',fontsize=fs2)
text(0.30,1.5,'$a/L_{Te}$',color='b',fontsize=fs2)
text(0.20,0.5,'$a/L_{ne}$',color='k',fontsize=fs2)
text(0.40,0.5,'s',color='r',fontsize=fs2)
xlabel('$\\rho$',fontsize=fs2)
xlim([0,0.9])
ylim([0,4])
xticks(array([0,0.35,0.6,0.9]),fontsize=fs2)
yticks(linspace(0,4,3),fontsize=fs2)
text(0.1,3.6,'(b)',fontsize=fs2-4)
plt.subplots_adjust(left=0.1, right=0.9, top=0.95, bottom=0.1, wspace=0.4, hspace=0.05)